# Deep Learning for ECG Classification and Metadata Analysis

## About the Project
This project was developed as part of the **Data Science and Computational Models in Biomedicine (CompBioMed)** course, a third-year elective course for all degrees of the School of Engineering at Universitat Pompeu Fabra (2025).  

The goal was to develop an **end-to-end automated ECG classification pipeline** that combines:
1. **Deep learning models** to classify ECG signals into three diagnostic superclasses:  
   NORM (Normal sinus rhythm), MI (Myocardial infarction), and STTC (ST-segment changes).
2. **Dimensionality reduction (PCA)** to explore and visualize patterns in patient metadata (age, sex, height, weight) and understand their relationship with diagnostic labels.

Unlike traditional ECG classifiers relying on handcrafted features, this work trains **ResNet1D** and **LSTM** architectures directly on raw ECG signals, enabling them to learn complex spatiotemporal patterns without manual feature engineering.

---

## Dataset
We used the **PTB-XL dataset**, a large, publicly available clinical ECG database containing **21,799 12-lead ECG records from 18,869 patients**.  
Each record is 10 seconds long, annotated with diagnostic statements reviewed by cardiologists, and accompanied by extensive metadata (age, sex, height, weight, etc.).

---

## Key Contributions
- **Developed and compared two deep learning architectures**:
  - **ResNet1D**, a one-dimensional adaptation of Residual Networks, using skip connections to avoid vanishing gradients and enabling deeper, more robust learning of ECG waveform patterns.
  - **LSTM**, a recurrent network architecture capable of learning long-term dependencies in sequential data, making it well-suited for detecting patterns across multiple cardiac cycles.
- **Processed and prepared** the PTB-XL dataset for multi-label classification, ensuring patient-wise splits to avoid data leakage.
- **Evaluated ECG signal quality** using Signal-to-Noise Ratio (SNR) analysis.
- **Performed dimensionality reduction (PCA)** on patient metadata to identify trends and correlations between biomarkers and diagnostic classes.

---

## Repository Contents
- [**`lstm.ipynb`**](./lstm.ipynb)  
  LSTM model training and evaluation.
- [**`resnet1d.ipynb`**](./resnet1d.ipynb)  
  ResNet1D model training and evaluation.
- [**`data_analysis.ipynb`**](./data_analysis.ipynb)  
  Metadata cleaning (for analysis only), dimensionality reduction, and signal quality analysis.
- [**`results/`**](./results)  
  Outputs generated by the notebooks.

---

## Execution Environment
All notebooks are prepared to run in **Google Colab** and assume the PTB-XL ZIP file is stored in a folder named `data` in Google Drive.  
Each notebook contains code to:
1. Load the ZIP file from Google Drive.
2. Extract it into the Colab environment.
3. Save results into a `results` folder in Google Drive.
